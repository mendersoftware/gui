{"version":3,"sources":["../src/Collapse.js"],"names":[],"mappings":"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","file":"Collapse.js","sourcesContent":["import React from 'react';\nimport {shouldComponentUpdate} from 'react/lib/ReactComponentWithPureRenderMixin';\nimport {Motion, spring} from 'react-motion';\nimport HeightReporter from 'react-height';\n\n\nconst PRECISION = 0.5;\n\n\nconst stringHeight = height => Math.max(0, parseFloat(height)).toFixed(1);\n\n\nconst Collapse = React.createClass({\n  propTypes: {\n    isOpened: React.PropTypes.bool.isRequired,\n    children: React.PropTypes.node.isRequired,\n    fixedHeight: React.PropTypes.number,\n    style: React.PropTypes.object, // eslint-disable-line react/forbid-prop-types\n    springConfig: React.PropTypes.objectOf(React.PropTypes.number),\n    keepCollapsedContent: React.PropTypes.bool,\n    onRest: React.PropTypes.func,\n    onHeightReady: React.PropTypes.func\n  },\n\n\n  getDefaultProps() {\n    return {\n      fixedHeight: -1,\n      style: {},\n      keepCollapsedContent: false,\n      onHeightReady: () => {} // eslint-disable-line no-empty-function\n    };\n  },\n\n\n  getInitialState() {\n    return {height: -1, isOpenedChanged: false};\n  },\n\n  componentWillMount() {\n    this.height = stringHeight(0);\n    this.renderStatic = true;\n  },\n\n\n  componentWillReceiveProps({isOpened}) {\n    this.setState({isOpenedChanged: isOpened !== this.props.isOpened});\n  },\n\n\n  shouldComponentUpdate,\n\n\n  componentDidUpdate({isOpened}) {\n    if (isOpened !== this.props.isOpened) {\n      const report = this.props.isOpened ? this.state.height : 0;\n\n      this.props.onHeightReady(report);\n    }\n  },\n\n\n  onHeightReady(height) {\n    const {isOpened, onHeightReady} = this.props;\n\n    if (this.renderStatic && isOpened) {\n      this.height = stringHeight(height);\n    }\n\n    this.setState({height: isOpened || !this.renderStatic ? height : 0});\n\n    const reportHeight = isOpened ? height : 0;\n\n    if (this.state.height !== reportHeight) {\n      onHeightReady(reportHeight);\n    }\n  },\n\n\n  getMotionHeight(height) {\n    const {isOpened, springConfig, fixedHeight} = this.props;\n    const {isOpenedChanged} = this.state;\n\n    const newHeight = isOpened ? Math.max(0, parseFloat(height)).toFixed(1) : stringHeight(0);\n\n    // No need to animate if content is closed and it was closed previously\n    // Also no need to animate if height did not change\n    const skipAnimation = !isOpenedChanged && !isOpened ||\n      this.height === newHeight && fixedHeight === -1;\n\n    const springHeight = spring(isOpened ? Math.max(0, height) : 0, {\n      precision: PRECISION,\n      ...springConfig\n    });\n    const instantHeight = isOpened ? Math.max(0, height) : 0;\n\n    return skipAnimation ? instantHeight : springHeight;\n  },\n\n\n  renderFixed() {\n    const {\n      springConfig: _springConfig,\n      onHeightReady: _onHeightReady,\n      onRest: _onRest,\n      isOpened,\n      style,\n      children,\n      fixedHeight,\n      keepCollapsedContent,\n      ...props\n    } = this.props;\n\n    if (this.renderStatic) {\n      this.renderStatic = false;\n      const newStyle = {overflow: 'hidden', height: isOpened ? fixedHeight : 0};\n\n      if (!keepCollapsedContent && !isOpened) {\n        return null;\n      }\n      this.height = stringHeight(fixedHeight);\n      return <div style={{...newStyle, ...style}} {...props}>{children}</div>;\n    }\n\n    return (\n      <Motion\n        defaultStyle={{height: isOpened ? 0 : fixedHeight}}\n        style={{height: this.getMotionHeight(fixedHeight)}}>\n        {({height}) => {\n          this.height = stringHeight(height);\n\n          // TODO: this should be done using onEnd from ReactMotion, which is not yet implemented\n          // See https://github.com/chenglou/react-motion/issues/235\n          if (!keepCollapsedContent && !isOpened && this.height === stringHeight(0)) {\n            return null;\n          }\n\n          const newStyle = {overflow: 'hidden', height};\n\n          return <div style={{...newStyle, ...style}} {...props}>{children}</div>;\n        }}\n      </Motion>\n    );\n  },\n\n\n  render() {\n    const {\n      springConfig: _springConfig,\n      onHeightReady: _onHeightReady,\n      isOpened,\n      style,\n      children,\n      fixedHeight,\n      keepCollapsedContent,\n      onRest,\n      ...props\n    } = this.props;\n\n    if (fixedHeight > -1) {\n      return this.renderFixed();\n    }\n\n    const renderStatic = this.renderStatic;\n    const {height} = this.state;\n    const currentStringHeight = parseFloat(height).toFixed(1);\n\n    if (height > -1 && renderStatic) {\n      this.renderStatic = false;\n    }\n\n    // Cache Content so it is not re-rendered on each animation step\n    const content = <HeightReporter onHeightReady={this.onHeightReady}>{children}</HeightReporter>;\n\n    if (renderStatic) {\n      const newStyle = isOpened ? {height: 'auto'} : {overflow: 'hidden', height: 0};\n\n      if (!isOpened && height > -1) {\n        if (!keepCollapsedContent) {\n          return null;\n        }\n\n        return (\n          <div style={{height: 0, overflow: 'hidden', ...style}} {...props}>\n            {content}\n          </div>\n        );\n      }\n\n      // <Motion> to prevent loosing input after causing this component to rerender\n      return (\n        <Motion\n          defaultStyle={{height: Math.max(0, height)}}\n          style={{height: Math.max(0, height)}}\n          onRest={onRest}>\n          {() =>\n            <div style={{...newStyle, ...style}} {...props}>{content}</div>\n          }\n        </Motion>\n      );\n    }\n\n    return (\n      <Motion\n        defaultStyle={{height: Math.max(0, height)}}\n        onRest={onRest}\n        style={{height: this.getMotionHeight(height)}}>\n        {st => {\n          this.height = stringHeight(st.height);\n\n          // TODO: this should be done using onEnd from ReactMotion, which is not yet implemented\n          // See https://github.com/chenglou/react-motion/issues/235\n          if (!isOpened && this.height === '0.0') {\n            if (!keepCollapsedContent) {\n              return null;\n            }\n            return (\n              <div style={{height: 0, overflow: 'hidden', ...style}} {...props}>{content}</div>\n            );\n          }\n\n          const newStyle = isOpened && this.height === currentStringHeight ? {height: 'auto'} : {\n            height: st.height, overflow: 'hidden'\n          };\n\n          return <div style={{...newStyle, ...style}} {...props}>{content}</div>;\n        }}\n      </Motion>\n    );\n  }\n});\n\n\nexport default Collapse;\n"]}